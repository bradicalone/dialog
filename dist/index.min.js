"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var DialogVarify=function(){function a(b,c){_classCallCheck(this,a),this.state={target:"",open:!1,resized:!1},this.dialog=b,this.offset=b.getBoundingClientRect(),this.offset.currentX=0,this.offset.currentY=0,this.extraPadding=30,this.inputAttributes=c,this.inputAttributes&&this.appendVarification()}return _createClass(a,[{key:"getFields",value:function(){return{email:"\n            <div class=\"Varification__email\">\n                <p class=\"Varification__title\">EMAIL MUSTS:</p>\n                <div class=\"NumSymbol\">\n                    <span class=\"Varification__moveOn\"></span>\n                    <p>Correct characters</p>\n                </div>\n            </div>\n            ",password:"\n            <div class=\"Varification__pwd\">\n                <p class=\"Varification__title\">PASSWORD MUSTS:</p>\n                <div class=\"Minimum\">\n                    <span class=\"Varification__moveOn\"></span>\n                    <p>Minimum of 8 characters</p>\n                </div>\n                <div class=\"NumSymbol\">\n                    <span class=\"Varification__moveOn\"></span>\n                    <p>At least one number or symbol</p>\n                </div>\n                <div class=\"UpperLower\">\n                    <span class=\"Varification__moveOn\"></span>\n                    <p>Upper and lower case letters</p>\n                </div>\n            </div>\n            "}}},{key:"appendVarification",value:function(){var a=this,b=new DocumentFragment,c=this.dialog.querySelector(".Dialog__layout"),d=document.createElement("div");d.className="Varification",d.innerHTML=this.inputAttributes.reduce(function(b,c){return b+a.getFields()[c]},""),b.appendChild(d),c.appendChild(b)}},{key:"open",value:function(a){this.target=a.target,this.state.target===this.target||this.moveTo(!0)}},{key:"close",value:function(){this.state.open&&this.moveTo(!1)}},{key:"debounce",value:function(a,b){var c,d=this;return function(){for(var e=arguments.length,f=Array(e),g=0;g<e;g++)f[g]=arguments[g];clearTimeout(c),c=setTimeout(function(){return a.apply(void 0,[d].concat(f))},b)}}},{key:"onResize",value:function(){var a=this;if(!this.state.resized){var b=document.body.getBoundingClientRect(),c=b.width,d=function d(b){var e=b[0].contentRect;c!=e.width&&a.debounce(function(){a.updatePos()},400)(),c=e.width};this.observer=new ResizeObserver(d),this.observer.observe(document.body),this.state.resized=!0}}},{key:"removeResize",value:function a(){this.observer.unobserve(document.body)}},{key:"getElements",value:function a(){return{dialog:this.dialog,innerEl:this.dialog.querySelector(".Dialog__inner"),arrow:this.dialog.querySelector(".Dialog__arrow"),varifyEl:this.dialog.querySelector(".Varification__".concat(this.target.name))}}},{key:"checkPos",value:function a(){var b=this.dialog.getBoundingClientRect(),c=this.target.getBoundingClientRect(),d=window.innerWidth-c.right>b.width+this.extraPadding&&c.y>b.height/2,e=c.x>b.width+this.extraPadding&&c.y>b.height/2,f=c.y+this.extraPadding>b.height;return{canFitRight:d,canFitLeft:e,canFitAbove:f,offsetX:b.x,targetPos:c,dialogPos:b}}},{key:"updatePos",value:function a(){var b=this.getElements(),c=b.dialog,d=b.arrow,e=this.getPos(),f=e.x,g=e.y,h=e.side;c.style.transform="translate(".concat(~~f,"px, ").concat(~~g,"px)"),d.className="Dialog__arrow --".concat(h),this.offset=this.dialog.getBoundingClientRect(),this.offset.currentX=f,this.offset.currentY=g}},{key:"getPos",value:function a(){var b=this.checkPos(),c=b.canFitRight,d=b.canFitLeft,e=b.canFitAbove,f=b.targetPos,g=b.dialogPos,h=this.offset.currentX+(f.right-g.x+this.extraPadding),i=this.offset.currentY+(f.bottom+this.extraPadding-g.y),j=0,k=0,l="";return d?(j=h-f.width-g.width-2*this.extraPadding,k=i-this.extraPadding-g.height/2-f.height/2,l="right"):c?(j=h,k=i-this.extraPadding-f.height/2-g.height/2,l="left"):(j=h-this.extraPadding-f.width/2-g.width/2,e?(k=i-g.height-this.extraPadding-2*f.height,l="bottom"):(k=i,l="top")),{x:j,y:k,side:l}}},{key:"showDetails",value:function a(){var b=this;Array.from(this.dialog.querySelectorAll(".Varification__email, .Varification__pwd")).forEach(function(a){a.classList.contains("Varification__".concat(b.target.name))?(b.verifyElement=a,a.style.opacity=1):a.style.opacity=0})}},{key:"moveTo",value:function c(b){var d=this,e=this.getElements(),f=e.dialog,g=e.innerEl,h=e.arrow,i=e.varifyEl,j=this.getPos(),k=j.x,l=j.y,m=j.side,n=b?450:300,o=b?55:45,p=this.checkPos(),q=p.canFitRight,r=p.canFitLeft,s=p.canFitAbove,t=!(q&&s||r&&s),u=!!f.style.transform&&b;f.style.transition=u?"transform .3s cubic-bezier(0.25, 1, 0.5, 1)":null,f.style.transform="translate(".concat(~~k,"px, ").concat(~~l,"px)"),h.className=b?"Dialog__arrow --".concat(m):"Dialog__arrow",g.style.transformOrigin=t?"left center":"center bottom",this.showDetails();var v=0,w=function e(c){var h=Math.min;v||(v=c);var j=h((c-v)/n,1),m=b?a.outCube(j):a.inCube(j),p=b?o-o*m:o*m,q=t?"rotateX(".concat(p,"deg)"):"rotateY(".concat(p,"deg)"),r=b?-50+50*j:0-50*j,s=" perspective(500px) translateZ("+r+"px)";if(d.state.open!==b&&(g.style.transform=q+s,g.style.opacity=b?1*m:1-1*m),1==j){if(!b)return d.inputAttributes&&i.removeAttribute("style"),d.dialog.style.pointerEvents="none",d.state={target:"",open:!1,resized:!1};d.dialog.style.pointerEvents="auto",d.offset.currentX=k,d.offset.currentY=l,d.state.open=b,d.state.target=d.target,f.style.transition=null,d.onResize()}else requestAnimationFrame(e)};requestAnimationFrame(w)}},{key:"checkValidation",value:function c(b){var d=b.target,e=b.target.value;if("pwd"==d.name){var f=a.getPasswordStrength(e);this.dialog.querySelectorAll(".Varification__pwd span").forEach(function(a,b){return f[b]?a.className="Varification__moveOn varify-active":void(a.className="Varification__moveOn")})}else if("email"==d.name){var g=a.checkEmail(e);this.dialog.querySelectorAll(".Varification__email span").forEach(function(a,b){return g[b]?a.className="Varification__moveOn varify-active":void(a.className="Varification__moveOn")})}}}],[{key:"emailPasses",value:function b(a){return /(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/.test(a)}},{key:"passesCharLength",value:function b(a){return 8<=a.length}},{key:"hasCapitalLower",value:function b(a){return /[A-Z]/.test(a)&&/[a-z]/.test(a)}},{key:"hasNumberChar",value:function b(a){return /[0-9]/.test(a)}},{key:"hasNumberSpecial",value:function b(a){return /[\"/$&+,:;=?@#0-9_|'.^*()%!-]/gi.test(a)}},{key:"isStringPassword",value:function b(a){return 1===getPasswordStrength(a)}},{key:"getPasswordStrength",value:function b(a){var c=[this.passesCharLength,this.hasNumberSpecial,this.hasCapitalLower];return c.map(function(b){return b(a)})}},{key:"checkEmail",value:function b(a){var c=[this.emailPasses];return c.map(function(b){return b(a)})}}]),a}();_defineProperty(DialogVarify,"outCube",function(a){return--a*a*a+1}),_defineProperty(DialogVarify,"inCube",function(a){return a*a*a});